<div class="min-h-screen bg-gray-50">
  <!-- Header Bar -->
  <div class="bg-white border-b border-gray-200">
    <!-- Navigation Breadcrumb -->
    <div class="px-[120px] py-4 border-b border-gray-100">
      <div class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="w-8 h-8 bg-gray-200 rounded"></div>
          <i class="pi pi-align-left text-gray-600"></i>
          <span class="font-semibold text-gray-700">ติดตามการทำรายการ</span>
          <i class="pi pi-angle-right text-gray-600"></i>
          <span class="text-gray-600">ประวัติการดึงข้อมูล</span>
        </div>
        
        <!-- User Info -->
        <div class="flex items-center space-x-3">
          <i class="pi pi-bell text-gray-600 text-lg cursor-pointer hover:text-gray-800"></i>
          <div class="flex items-center space-x-3 bg-gray-50 rounded-xl px-4 py-2">
            <div class="w-10 h-10 bg-green-100 text-green-700 rounded-full flex items-center justify-center font-bold">
              ชน
            </div>
              <div class="text-sm pr-6">
                <div class="font-semibold text-gray-800">ชื่อ นามสกุล</div>
                <div class="text-green-600 italic">i1234567</div>
              </div>
            <i class="pi pi-chevron-down text-gray-500 cursor-pointer"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="px-[120px] py-6">
    <!-- Page Header -->
    <div class="flex items-center justify-between mb-6">
      <div class="flex items-center space-x-3">
        <h1 class="text-2xl font-bold text-gray-800">ประวัติการดึงข้อมูล</h1>
        <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium">
          100 รายการ
        </span>
      </div>
      
      <!-- Action Buttons -->
      <div class="flex space-x-3">
        <p-button 
          label="ดึงข้อมูลล่าสุด" 
          icon="pi pi-sync" 
          [outlined]="true"
          styleClass="p-button-outlined !bg-white !border-blue-800 !text-blue-800 hover:!bg-blue-50">
        </p-button>
        <p-button 
          label="ส่งข้อมูลมา" 
          icon="pi pi-sync" 
          [outlined]="true"
          styleClass="p-button-outlined !bg-white !border-red-600  !bg-orange-50 !text-red-600 hover:!bg-red-50">
        </p-button>
        <p-button 
          label="Export" 
          icon="pi pi-download" 
          styleClass="!bg-green-800 !border-green-800 !text-white hover:!bg-green-900">
        </p-button>
      </div>
    </div>

          <!-- Filters -->
    <div class="bg-white rounded-t-lg shadow-sm border border-gray-200 p-6">
      <div class="flex flex-wrap gap-4 items-end">
        <!-- Date Range -->
        <div class="flex-1 min-w-[250px]">
          <label class="block text-sm font-medium text-gray-700 mb-2">
            ช่วงเวลาที่ทำรายการ
          </label>
          <p-dropdown 
            [options]="dateRangeOptions" 
            [(ngModel)]="selectedDateRange"
            optionLabel="label"
            placeholder="เลือกช่วงวันที่"
            styleClass="w-full">
          </p-dropdown>
        </div>

        <!-- Department -->
        <div class="w-40">
          <label class="block text-sm font-medium text-gray-700 mb-2">
            ประเภทงาน
          </label>
          <p-dropdown 
            [options]="departmentOptions" 
            [(ngModel)]="selectedDepartment"
            optionLabel="label"
            placeholder="ทั้งหมด"
            styleClass="w-full">
          </p-dropdown>
        </div>

        <!-- User -->
        <div class="w-40">
          <label class="block text-sm font-medium text-gray-700 mb-2">
            ผลการดึงข้อมูล
          </label>
          <p-dropdown 
            [options]="userOptions" 
            [(ngModel)]="selectedUser"
            optionLabel="label"
            placeholder="ทั้งหมด"
            styleClass="w-full">
          </p-dropdown>
        </div>

        <!-- Search -->
        <div class="flex-1 min-w-[250px]">
          <label class="block text-sm font-medium text-gray-700 mb-2">
            ผู้ที่สั่งดึงข้อมูล
          </label>
          <div class="relative">
            <input 
              type="text" 
              [(ngModel)]="searchText"
              placeholder="กรอกชื่อพนักงาน"
              class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <i class="pi pi-user absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-700"></i>
          </div>
        </div>

        <!-- Search Button -->
        <div class="w-[100px]">
          <p-button 
            label="ค้นหา" 
            icon="pi pi-search"
            styleClass="w-full !bg-gray-100 !border-gray-300 !text-gray-700 hover:!bg-gray-50">
          </p-button>
        </div>
      </div>
    </div>

    <!-- Data Table -->
    <div class="bg-white rounded-b-lg shadow-sm border border-gray-200 border-t-0">
      <p-table [value]="dataFetchRecords" styleClass="p-datatable-sm">
        <ng-template pTemplate="header">
          <tr>
            <th class="text-left p-4 font-semibold text-gray-700">วัน/เวลา<br>ที่ทำรายการ</th>
            <th class="text-left p-4 font-semibold text-gray-700">ประเภทงาน</th>
            <th class="text-left p-4 font-semibold text-gray-700">จำนวนรายการ</th>
            <th class="text-left p-4 font-semibold text-gray-700"></th>
            <th class="text-left p-4 font-semibold text-gray-700">ผู้ที่สั่งดึงข้อมูล</th>
            <th class="text-left p-4 font-semibold text-gray-700">ผลการดึงข้อมูล</th>
            <th class="w-12"></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-record>
          <tr class="border-b border-gray-100 hover:bg-gray-50">
            <!-- Date/Time -->
            <td class="p-4">
              <div class="text-sm">
                <div class="font-medium text-gray-900">{{record.date}}</div>
                <div class="text-gray-500 italic">{{record.time}}</div>
              </div>
            </td>

            <!-- Status -->
            <td class="p-4">
                <p-tag 
                  [value]="record.status" 
                  [severity]="'secondary'"
                  [rounded]="true"
                  [ngClass]="{
                    'custom-blue-tag': record.status === 'ข้อมูลสินค้า',
                    'custom-orange-tag': record.status === 'ข้อมูลราคา',
                    'custom-success-tag': record.status === 'ข้อมูลสำเร็จ'
                  }">
                </p-tag>
            </td>

            <!-- Progress-bar -->
            <td class="p-4 progress-segments-container">
              <div class="space-y-2">
                
                <!-- Total Count -->
                <div class="text-base font-bold">
                  <span class="text-gray-900">{{record.totalRecords}}</span>
                  <span class="text-gray-300"> รายการ</span>
                </div>
                
                <!-- Progress Bar with Segments -->
                <div class="flex items-center h-6 progress-segments-bar">
                  <!-- Green segments -->
                  <div class="flex">
                    <div 
                      *ngFor="let i of [].constructor(Math.round(record.successPercentage/100 * 20))"
                      class="w-1 h-5 bg-green-500 rounded-sm progress-segment-green">
                    </div>
                  </div>
                  <!-- Red segments -->
                  <div class="flex">
                    <div 
                      *ngFor="let i of [].constructor(Math.round(record.failurePercentage/100 * 20))"
                      class="w-1 h-5 bg-red-500 rounded-sm progress-segment-red">
                    </div>
                  </div>
                </div>
                </div>
            </td>

            <!-- Progress-total -->
            <td class="p-4">
              <div class="space-y-3">
                
                <!-- Stats -->
                <div class="space-y-1">
                  <!-- Success -->
                  <div class="flex items-center space-x-2 text-xs">
                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                    <span class="text-gray-600">สำเร็จ</span>
                    <span class="font-medium text-green-600">{{record.successPercentage}}%</span>
                    <span class="text-gray-400">{{record.successCount}} รายการ</span>
                  </div>
                  <!-- Failure -->
                  <div class="flex items-center space-x-2 text-xs">
                    <div class="w-2 h-2 bg-red-500 rounded-full"></div>
                    <span class="text-gray-600">ล้มเหลว</span>
                    <span class="font-medium text-red-600">{{record.failurePercentage}}%</span>
                    <span class="text-gray-400">{{record.failureCount}} รายการ</span>
                  </div>
                </div>
              </div>
            </td>

            <!-- User Info -->
            <td class="p-4">
              <div class="flex items-center space-x-3">
                <!-- Avatar or Settings Icon -->
                <div *ngIf="record.user.name === 'System' && record.user.id === 'Scheduling Job'" 
                     class="w-8 h-8 bg-gray-700 text-white rounded-full flex items-center justify-center">
                  <i class="pi pi-cog text-sm"></i>
                </div>
                <div *ngIf="!(record.user.name === 'System' && record.user.id === 'Scheduling Job')" 
                     class="w-8 h-8 bg-green-100 text-green-700 rounded-full flex items-center justify-center text-xs font-bold">
                  {{record.user.avatar}}
                </div>
                <div class="text-sm">
                  <div class="font-medium text-gray-900">{{record.user.name}}</div>
                  <div class="italic" 
                       [ngClass]="{
                         'text-yellow-600': record.user.name === 'System' && record.user.id === 'Scheduling Job',
                         'text-green-600': !(record.user.name === 'System' && record.user.id === 'Scheduling Job')
                       }">
                    {{record.user.id}}
                  </div>
                </div>
              </div>
            </td>

            <!-- Status Badge -->
            <td class="p-4">
              <span 
                class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium"
                [ngClass]="{
                  'bg-green-100 text-green-800': record.statusColor === 'success',
                  'bg-orange-100 text-orange-800': record.statusColor === 'warning',
                  'bg-red-100 text-red-800': record.statusColor === 'danger'
                }">
                <span class="w-2 h-2 rounded-full mr-2 inline-block"
                      [ngClass]="{
                        'bg-green-500': record.statusColor === 'success',
                        'bg-orange-500': record.statusColor === 'warning',
                        'bg-red-500': record.statusColor === 'danger'
                      }"></span>
                {{record.statusColor === 'success' ? 'สำเร็จ' : 
                  record.statusColor === 'warning' ? 'ล้มเหลวบางรายการ' : 'ล้มเหลว'}}
              </span>
            </td>

            <!-- Action Menu -->
            <td class="p-4">
              <i class="pi pi-file text-gray-400 cursor-pointer hover:text-gray-600"></i>
            </td>
          </tr>
        </ng-template>
      </p-table>

      <!-- Pagination -->
      <div class="border-t border-gray-200 px-6 py-4">
        <div class="flex items-center justify-between">
          <!-- Previous Button -->
          <button class="px-3 py-1 text-sm text-gray-600 border-gray-400 hover:text-gray-800 border rounded-lg px-4 py-2">
            <i class="pi pi-arrow-left"></i> ก่อนหน้า
          </button>
          
          <!-- Page Numbers -->
          <div class="flex space-x-1">
            <button class="px-4 py-2 text-sm bg-green-100 text-green-700 rounded">1</button>
            <button class="px-3 py-1 text-sm text-gray-600 hover:text-gray-800  rounded">2</button>
            <button class="px-3 py-1 text-sm text-gray-600 hover:text-gray-800  rounded">3</button>
            <span class="px-2">...</span>
            <button class="px-3 py-1 text-sm text-gray-600 hover:text-gray-800  rounded">8</button>
            <button class="px-3 py-1 text-sm text-gray-600 hover:text-gray-800  rounded">9</button>
            <button class="px-3 py-1 text-sm text-gray-600 hover:text-gray-800  rounded">10</button>
          </div>
          
          <!-- Next Button -->
          <button class="px-3 py-1 text-sm text-gray-600 border-gray-400 hover:text-gray-800 border rounded-lg px-4 py-2">
            ถัดไป <i class="pi pi-arrow-right"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
